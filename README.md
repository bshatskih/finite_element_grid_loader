
# ЛАБОРАТОРНАЯ РАБОТА № 1

**по курсу «Основы программирования на C++»**

## Разработка конечно-элементного загрузчика сетки

Разработать конечно-элементный загрузчик сеток.

Предусмотреть потенциальную возможность работы с различными форматами файлов конечно-элементной (КЭ) сетки.  
Создать базовый класс `MeshLoader`. Объявить в нем чисто виртуальный метод `loadMesh`.

Создать производный от `MeshLoader` класс `AneuMeshLoader`, в котором переопределить метод `loadMesh`.  
Данный класс должен обеспечивать загрузку сетки из формата `.aneu` (см. Приложение 2).

Предусмотреть возможность консольного запуска бинарного файла и передачи имени загружаемого файла в параметрах командной строки.

Для хранения данных сетки и операций над ней создать отдельный класс `Mesh`.  
Объект данного класса должен возвращаться как результат работы метода `loadMesh`.

В отдельном `h`-файле создать следующие вспомогательные типы данных для класса `Mesh`:

- `Node` — тип данных «узел». Хранит ID узла (>= 1), декартовы координаты узла и флаг, определяющий, является ли данный узел вершиной КЭ или его внутренним узлом.
- `FiniteElement` — тип данных «конечный элемент» (КЭ). Хранит ID КЭ (>= 1), ID геометрической области, которой принадлежит КЭ по данным файла сетки (например, ID грани, которой принадлежит граничный КЭ (треугольник) или ID объема, которому принадлежит объемный КЭ (тетраэдр)), список ID узлов КЭ.

### Методы класса `Mesh`:

- Методы, позволяющие получить STL-контейнеры узлов, конечных элементов и граничных элементов.
- Метод, возвращающий контейнер ID тетраэдральных КЭ по ID трех вершинных узлов (использовать `std::find_if` и предикат).
- Метод, возвращающий контейнер ID тетраэдральных КЭ с общим ребром, заданным двумя ID узлов.
- Метод, возвращающий контейнер ID граничных узлов по ID границы геометрической модели.
- Метод, возвращающий контейнер ID тетраэдральных КЭ с заданным ID области.
- Метод, возвращающий контейнер ID граничных КЭ с заданным ID границы.
- Метод, производящий вставку новых узлов в середины рёбер существующих КЭ (включая граничные). Обновляются списки узлов КЭ и общий список узлов.
- Метод, создающий контейнер, где n-й элемент — контейнер ID всех соседних по рёбрам узлов для узла n.
- Методы, реализующие форматированный вывод `Node` и `FiniteElement` в поток.

**Дополнительно:** можно определить другие вспомогательные методы и типы данных.

---

### Основные требования

- Для чтения файла использовать `std::ifstream`.
- Предполагается большой объем сетки — методы должны быть эффективны по времени.
- Использовать STL: контейнеры, итераторы, алгоритмы. Минимизировать циклы.
- Обработка ошибок через исключения. Возможные ошибки:
  - Файл не найден;
  - Неверный формат файла;
  - И др.

Сетки в формате `.neu` могут быть сгенерированы в [NetGen](http://sourceforge.net/projects/netgen-mesher/).  
Чтобы преобразовать `.neu` в `.aneu`, добавить:
- В строку с количеством узлов — размерность пространства.
- В строку с количеством КЭ — число узлов в одном КЭ.
- В строку с количеством граничных КЭ — число узлов в одном граничном КЭ.

---

## Для самостоятельного изучения:

- Перенаправление стандартных потоков ввода и вывода в файлы.

---

## Приложение 1. Формат файла `.neu`

```
<Количество узлов>
X1 X2 X3
...
X1 X2 X3

<Количество КЭ>
<ID материала> N1 N2 N3 N4
...
<ID материала> N1 N2 N3 N4

<Количество поверхностных КЭ>
<ID поверхности> N1 N2 N3
...
<ID поверхности > N1 N2 N3
```

---

## Приложение 2. Формат файла `.aneu`

Формат получается вручную из `.neu` с добавлением информации:

```
<Количество узлов> <Размерность пространства>
X1 X2 X3
...
X1 X2 X3

<Количество КЭ> <Количество узлов в одном КЭ>
<ID материала> N1 N2 N3 N4
...
<ID материала> N1 N2 N3 N4

<Количество поверхностных КЭ> <Количество узлов в одном поверхностном КЭ>
<ID поверхности> N1 N2 N3
...
<ID поверхности > N1 N2 N3
```

---

## Приложение 3. Генерация сетки в NetGen 5.3

1. Создать `.geo` файл по примерам.
2. Открыть файл через `File -> Load Geometry`.
3. Настроить сетку в `Mesh -> Meshing Options`.
4. Нажать `Generate Mesh`.
5. Сохранить: `File -> Export Mesh`, выбрать `.neu`.
6. Преобразовать `.neu` в `.aneu`.

**Скачать NetGen 5.3:**  
[https://sourceforge.net/projects/netgen-mesher/files/netgen-mesher/5.3/](https://sourceforge.net/projects/netgen-mesher/files/netgen-mesher/5.3/)
